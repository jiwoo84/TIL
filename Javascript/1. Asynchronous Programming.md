# Asynchronous Programming

# ë™ê¸°/ ë¹„ë™ê¸°

![Untitled](Asynchronous%20Programming%2080a4a4ad358a4f9ea5a46837769d0193/Untitled.png)

- ë™ê¸°(synchronous) : ìš”ì²­ì„ ë³´ë‚¸ í›„ ì‘ë‹µì„ ë°›ì•„ì•¼ ë‹¤ìŒ ë™ì‘ ì‹¤í–‰
- ë¹„ë™ê¸°(asynchronous) : ìš”ì²­ì„ ë³´ë‚¸ í›„ ì‘ë‹µê³¼ ê´€ê³„ì—†ì´ ë‹¤ìŒ ë™ì‘ ì‹¤í–‰
    
    ì‹¤í–‰ì‹œê°„ì´ ì˜¤ë˜ê±¸ë¦¬ëŠ” ê¸°ëŠ¥ì€ ë¹„ë™ê¸°ê°€ ì¢‹ìŒ â‡’ ë™ê¸°ëŠ” ê·¸ ì¤„ì—ì„œ ë§‰íˆë©´ ë‹¤ìŒì¤„ì´ ì‹¤í–‰ë˜ì§€ ì•Šê³  ë©ˆì¶”ê¸° ë•Œë¬¸
    
    ex) `setTimeout(() => console.log('boom'), 1000);` 1ì´ˆ ë’¤ ì‹¤í–‰
    

## ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°

---

ììŠ¤ëŠ” í•˜ë‚˜ì˜ ë©”ì¸ìŠ¤ë ˆë“œë¡œ êµ¬ì„±ë¨ (ë‹¤ë¥¸ ì–¸ì–´ë“¤ì€ ë©€í‹°ìŠ¤ë ˆë“œ)

- ì½”ë“œë¥¼ í•œ ì¤„ì”© ì½ê³  ì‹¤í–‰
- ë¹„ë™ê¸° ì²˜ë¦¬ ì œê³µ x , but ì •í•´ì§„ í•¨ìˆ˜(API) í™œìš©í•´ì„œ êµ¬í˜„ ê°€ëŠ¥
    
    ex) `setTimeout`, `XMLHttpRequest`, `fetch`ë“±ì˜ web API
    
- node.jsëŠ” íŒŒì¼ ì²˜ë¦¬ API, ì•”í˜¸ ì²˜ë¦¬ API ë“±ì„ ì œê³µ

## ë¹„ë™ê¸° ì²˜ë¦¬ ëª¨ë¸

---

![42eatw03fcha0e1qcrf0.gif](Asynchronous%20Programming%2080a4a4ad358a4f9ea5a46837769d0193/42eatw03fcha0e1qcrf0.gif)

- ì´ë²¤íŠ¸ ë£¨í”„ : ì½œ ìŠ¤íƒì´ ë¹„ë©´ quequì—ì„œ í•¨ìˆ˜ë¥¼ ë„£ì–´ì¤Œ, ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ ì™¸ë¶€ì— ì¡´ì¬

### queuqê°€ ë„˜ê²¨ë°›ëŠ” ì‘ì—…

- ì¼ë°˜ ë™ê¸° í•¨ìˆ˜ â‡’ call stackìœ¼ë¡œ ë°”ë¡œ ë„˜ê²¨ì§
- ì¼ë°˜ì ì¸ ë¹„ë™ê¸° í•¨ìˆ˜ â‡’ macrotask queueì— ì €ì¥
- `Promise`, `async` / `await`, `process.nextTick`, `Object.observe`, `MutationObserver` â‡’ microtask queueì— ì €ì¥

### **ì‹¤í–‰ ìˆœì„œ**

<aside>
ğŸ“Œ ìš°ì„ ìˆœìœ„: microtask queue > Animation Frames > macrotask queue

</aside>

1. ë™ê¸° í•¨ìˆ˜ëŠ” call stackì— ìŒ“ì„ â†’ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰
2. ì´ë²¤íŠ¸ ë£¨í”„ëŠ” ì½œìŠ¤íƒì´ ë¹„ë©´ task quequì— ìˆëŠ” í•¨ìˆ˜ë¥¼ ê°€ì ¸ì™€ì„œ ì½œìŠ¤íƒì— ë„£ìŒ (ìš°ì„ ìˆœìœ„ì— ë”°ë¼)
    - ì´ë²¤íŠ¸ ë£¨í”„ëŠ” Microtask Queueë‚˜ Animation Framesë¥¼ ë°©ë¬¸í•  ë•ŒëŠ”, í ì•ˆì— ìˆëŠ”Â **ëª¨ë“  ì‘ì—…ë“¤ì„ ìˆ˜í–‰**í•˜ì§€ë§Œ, Task Queueë¥¼ ë°©ë¬¸í•  ë•ŒëŠ”Â **í•œ ë²ˆì— í•˜ë‚˜ì˜ ì‘ì—…**ë§Œ call stackìœ¼ë¡œ ì „ë‹¬í•˜ê³  ë‹¤ë¥¸ Queueë¥¼ ìˆœíšŒí•¨
3. ì‹¤í–‰ë˜ë©´ ì½œìŠ¤íƒì—ì„œ ì‚­ì œë¨

# promise

ì¼ë°˜ í•¨ìˆ˜ì²˜ëŸ¼ ê°’ì„ ë°›ì•„ì˜¤ë©´ ë¹„ë™ê¸°ì ì¸ ë™ì‘ì„ ê¸°ë‹¤ë ¤ì£¼ì§€ ì•Šê¸° ë•Œë¬¸ì— ë¹„ë™ê¸°ì ì¸ í•¨ìˆ˜ì˜ ê°’ì„ ë°›ëŠ” ë°©ì‹ì´ ë”°ë¡œ í•„ìš”í•¨. ê·¸ ë°©ì‹ ì¤‘ í•˜ë‚˜ê°€ Promise

- **ë§Œì•½ í”„ë¼ë¯¸ìŠ¤ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´?**
    
    ë°ì´í„°ë¥¼ ë°›ê³  ì½œë°± í•¨ìˆ˜ë¥¼ ì¤‘ì²©í•´ì„œ ë¶ˆëŸ¬ì˜¤ëŠ” ê³¼ì •ì—ì„œ ì—ëŸ¬ í•¸ë“¤ë§ì´ ì–´ë µë‹¤. ê°€ë…ì„±ì´ ë‚˜ì˜ê³  ì½œë°±ì§€ì˜¥ì´ ìƒì„±ë˜ë©° ì˜¤ë¥˜ë¥¼ ì¼ìœ¼í‚¬ í™•ë¥ â†‘
    
- **í”„ë¼ë¯¸ìŠ¤ì˜ ì‚¬ìš© íš¨ê³¼**
    
    > ë°ì´í„°ë¥¼ ë°›ìŒ â†’ (ì„±ê³µ) ì‹¤í–‰ / (ì‹¤íŒ¨) ì—ëŸ¬ ëŒ€ì‘
    > 
    
    í”„ë¼ë¯¸ìŠ¤ëŠ” ì„±ê³µ/ì‹¤íŒ¨ ê°ê°ì˜ ê²½ìš°ì— js ë‚´ë¶€ í•¨ìˆ˜ë¥¼ í™œìš©í•´ì„œ ì‹¤í–‰ë˜ëŠ” êµ¬ì¡°ë¥¼ ë§Œ ë“¤ ìˆ˜ ìˆìŒ
    
- **í”„ë¼ë¯¸ìŠ¤ì˜ êµ¬ì¡°**
    
    í”„ë¼ë¯¸ìŠ¤ëŠ” ì œì‘-ì†Œë¹„ ì‚¬ì´ë¥¼ ì—°ê²°í•´ì£¼ëŠ” íŠ¹ë³„í•œ ê°ì²´
    
    - ì œì‘ ì½”ë“œ(producing code) : ë¸Œë¼ìš°ì €ì—ì„œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜´
    - ì†Œë¹„ ì½”ë“œ(consuming code) : ì´ë¥¼ ê¸°ë‹¤ë ¸ë‹¤ê°€ ì‹¤í–‰í•¨. ì†Œë¹„ í•¨ìˆ˜ëŠ” ì—¬ëŸ¬ê°œê°€ ë  ìˆ˜ ìˆìŒ

### ì½œë°± í•¨ìˆ˜ / í”„ë¼ë¯¸ìŠ¤ / async & await ì‚¬ìš© ì˜ˆì‹œ

```jsx
// ë¹„ë™ê¸°ì  í•¨ìˆ˜
function calSum(a, b) {
	setTimeout(() => {
		return a + b;
	}, 1000)
}

console.log(calSum(1,2)); // undefined => 1ì´ˆ í›„ì— returnë˜ëŠ” calSumì˜ ê²°ê³¼ë¥¼ ê¸°ë‹¤ë ¤ì£¼ì§€ ì•ŠìŒ
// ê·¸ëŸ¬ë¯€ë¡œ í”„ë¡œë¯¸ìŠ¤ ê°™ì€ ë°©ì‹ ì‚¬ìš©

// ì½œë°±ì§€ì˜¥ ì˜ˆì‹œ (ì„¸ ê°œì˜ ë°ì´í„° ë°›ì•„ì˜¤ê¸°)
const cb = function(arg) {
	console.log(arg)
}

function getName(cb) {
    setTimeout(() => {
        cb("Elice");
    }, 2000);
}

function getAge(cb) {
    setTimeout(() => {
        cb(6);
    }, 2000);
}

function getAddress(cb) {
    setTimeout(() => {
        cb("Seoul");
    }, 2000);
}
	// ì—¬ëŸ¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œ, ì½œë°±ì§€ì˜¥ í˜•ì„±
getName((name) => {
    getAge((age) => {
        getAddress((address) => {
            console.log(name, age, address)
        })
    })
})

// í”„ë¼ë¯¸ìŠ¤ ì‚¬ìš© =>ê° í•¨ìˆ˜ë¥¼ í”„ë¼ë¯¸ìŠ¤ë¥¼ ë°˜í™˜í•˜ê²Œ ë³€ê²½
function getName() {
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve("Elice");
        }, 2000);
    })
}

function getAge() {
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve(6);
        }, 2000);
    })
}

function getAddress() {
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve("Seoul");
        }, 2000);
    })
}

Promise
		.all([getName(), getAge(), getAddress()])
		.then((res) => {
			const [name, age, address] = res;
			console.log(name, age, address)
		})

// async / await ì‚¬ìš©
(async () => {
    const name = await getName();
    const age = await getAge();
    const address = await getAddress();

    console.log(name, age, address);
})();
```

## producer (ì œì‘ì)

---

executor ì‹¤í–‰ â†’ ì„±ê³µ ì—¬ë¶€ì— ë”°ë¼ (ì„±ê³µ)`resolve` / (ì‹¤íŒ¨)`reject` í˜¸ì¶œ

```jsx
// í•¨ìˆ˜ í‘œí˜„ì‹
let promise = new Promise((resolve, reject) => {
	// executor (ë‘ ì¸ìë¥¼ ë°›ì•„ ì‹¤í–‰í•˜ëŠ” ì½œë°±í•¨ìˆ˜)
});

// í•¨ìˆ˜ ì„ ì–¸ì‹
function promise() {
	return new Promise((resolve, reject) => {
	// executor (ë‘ ì¸ìë¥¼ ë°›ì•„ ì‹¤í–‰í•˜ëŠ” ì½œë°±í•¨ìˆ˜)
});
```

### **ì¸ì**

- JS ìì²´ ì œê³µ ì½œë°±í•¨ìˆ˜ â‡’ ì§ì ‘ êµ¬í˜„í•  í•„ìš”x
- ë‘˜ ì¤‘ í•˜ë‚˜ ë°˜ë“œì‹œ í˜¸ì¶œí•  ê²ƒ

```jsx
let promise = new Promise(function(resolve, reject) {
  resolve("ì™„ë£Œ");
  reject(new Error("â€¦")); // ì„±ê³µí•˜ë©´ ë¬´ì‹œë¨
});
```

1. `**resolve`** : ì²˜ë¦¬ ì„±ê³µ â†’ then ì‹¤í–‰ (ì¸ì: ê²°ê³¼ê°’)
    - staticê³¼ì˜ ì—°ê´€ì„±
        
        ![Untitled](Asynchronous%20Programming%2080a4a4ad358a4f9ea5a46837769d0193/Untitled%201.png)
        
2. `**reject**` : ì²˜ë¦¬ ì‹¤íŒ¨ â†’ `catch` ì‹¤í–‰ (ì¸ì: ì—ëŸ¬ ê°ì²´) / then
    
    (ì–´ë–¤ íƒ€ì…ë„ ê°€ëŠ¥í•˜ì§€ë§Œ `Error`ê°ì²´ or `Error`ë¥¼ ìƒì†ë°›ì€ ê°ì²´ ì „ë‹¬ì„ ì¶”ì²œ)
    
    ex) `reject(new Error('error message'))`
    
    errorê°ì²´ëŠ” ì½˜ì†”ì— ì—ëŸ¬ì°½ì„ ì‹¤í–‰ì‹œí‚¤ë©° ìŠ¤í¬ë¦½íŠ¸ ì¤‘ë‹¨
    
    consumerì˜ catch ë¶€ë¶„ì—ì„œ ì´ë¥¼ ì˜ í•¸ë“¤ë§í•˜ë©´ ì¤‘ë‹¨x
    

<aside>
ğŸ’¡ promise ìƒì„±ë˜ìë§ˆì executor í•¨ìˆ˜ ì‹¤í–‰
â†’ ì²˜ë¦¬ ì„±ê³µ ì—¬ë¶€ì— ë”°ë¼ resolve / reject í˜¸ì¶œ

</aside>

### **promiseì˜ ë‚´ë¶€ í”„ë¡œí¼í‹°**

- state : ì´ˆê¸°ê°’ `"pending"`
    - ë¹„ë™ê¸° ì²˜ë¦¬ ì„±ê³µ â‡’ resolve í˜¸ì¶œâ†’ `"fulfilled"`
    - ë¹„ë™ê¸° ì²˜ë¦¬ ì‹¤íŒ¨ â‡’ reject í˜¸ì¶œâ†’ `"rejected"`
    
    â†’ í˜¸ì¶œ í›„ì—ëŠ” `â€œsetteldâ€` (í•œ ë²ˆ `setteld`ëœ ê°’ì€ ì¬ì‹¤í–‰ ë¶ˆê°€)
    
    ë³€ê²½ëœ ìƒíƒœëŠ” ë” ì´ìƒ ë³€í•˜ì§€ ì•ŠìŒ
    
- result : ê²°ê³¼ê°’ìœ¼ë¡œ, ì´ˆê¸°ê°’ì€ `undefined`
    - resolve í˜¸ì¶œ â†’ `value`
    - reject í˜¸ì¶œ â†’ `error` ê°ì²´

## consumer (ì†Œë¹„ì)

---

í”„ë¼ë¯¸ìŠ¤ ê°ì²´ì˜ ë‚´ì¥í•¨ìˆ˜ `then`, `catch`, `finally`ë¡œ `resolve`, `reject` ì½œë°± í•¨ìˆ˜ì˜ ì¸ìë¥¼ ë°›ì•„ ì‹¤í–‰

### then

`promise.then(([res, [error]) â‡’ ë‹¤ìŒì— í•  ë™ì‘)`

`resolve` í˜¸ì¶œ í›„ ê²°ê³¼ê°’ì€ `then`ì˜ ì¸ìë¡œ ë„˜ì–´ê°€ì„œ ì‹¤í–‰

- ë°˜í™˜ê°’ì´ promiseë¼ì„œ ì²´ì´ë‹ ê°€ëŠ¥ (catchë„ ë§ˆì°¬ê°€ì§€)
- error ê°ì²´ë¥¼ ë°›ì•„ì„œ ì—ëŸ¬ ì²˜ë¦¬ë„ ê°€ëŠ¥
    
    catch ì—†ì´ thenì—ì„œ ì—ì²˜ ì²˜ë¦¬í•œë‹¤ë©´ â‡’ thenì—ì„œ ë°œìƒí•œ ì—ëŸ¬ëŠ” ì²˜ë¦¬ ë¶ˆê°€ (ë’¤ì— catch ìˆë‹¤ë©´ ê±°ê¸°ë¡œ ë„˜ì–´ê°)
    
- error ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ throw í•˜ë©´ catchë¡œ ë„˜ì–´ê°
    
    ex) `throw new Error('error ë°œìƒ!')`
    

```jsx
promise.then(rep => {
	function(rep), { /* ì„±ê³µ: ê²°ê³¼ê°’ ë°›ì•„ ì‹¤í–‰ */ },
  function(error) { /* ì‹¤íŒ¨: error ê°ì²´ ë°›ì•„ ì‹¤í–‰ */ }
	});
```

- ì½”ë“œ ì¤„ì´ê¸°
    
    ```jsx
    promise.then(res => console.log(res));
    // ì¶•ì•½
    promise.then(console.log)
    ```
    

### catch

1. í”„ë¼ë¯¸ìŠ¤ ì•ˆì—ì„œ `reject(error)` í˜¸ì¶œ â†’ ê²°ê³¼ê°’ì´ ì¸ìë¡œ ë„˜ì–´ê°€ì„œ ì‹¤í–‰
2. thenì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´, error ê°ì²´ê°€ ì•Œì•„ì„œ ì „ë‹¬
- ì—ëŸ¬ë¥¼ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ìŠ¤í¬ë¦½íŠ¸ ì¤‘ë‹¨x
- `catch()` ì´í›„ì—ë„ ì²´ì´ë‹ ê°€ëŠ¥
- errorê°€ catchì—ì„œ í•œ ë²ˆ ì²˜ë¦¬ë˜ë©´, ë‹¤ìŒ ìƒìœ„ catchë¡œ ë„˜ì–´ê°€ì§€ ì•ŠìŒ
    - ë§Œì•½ ìƒìœ„ catchë¡œ ë„˜ê¸°ê³  ì‹¶ìœ¼ë©´, catch ì•ˆì—ì„œ ë‹¤ì‹œ throwí•´ì•¼ í•¨

```jsx
promise
	.catch(error => {
		// ì—ëŸ¬ ë°œìƒì‹œ ì‹¤í–‰
	})
	.finally( {~} ) // ì‹¤í–‰ ì—¬ë¶€ ìƒê´€ì—†ì´ ì‹¤í–‰
```

### finally

ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€ì— ìƒê´€ì—†ì´ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜

- ì¸ìˆ˜ê°€ ì—†ì–´ í”„ë¼ë¯¸ìŠ¤ ì‹¤í–‰ ì—¬ë¶€ë¥¼ ì•Œ ìˆ˜ ì—†ìŒ
    
    â‡’ ì‹¤í–‰ ì—¬ë¶€ ë¶ˆí•„ìš”í•œ ë™ì‘ì„ ì‹¤í–‰ì‹œì¼œì•¼ í•¨
    
- ìë™ìœ¼ë¡œ ë‹¤ìŒ í•¸ë“¤ëŸ¬ì— ê²°ê³¼ì™€ ì—ëŸ¬ë¥¼ ì „ë‹¬
    
    â‡’ then,catch ì•ì— ì¨ë„ ë¨
    

```jsx
new Promise((resolve, reject) => {
  setTimeout(() => resolve("ê²°ê³¼"), 2000)
})
  .finally(() => alert("í”„ë¼ë¯¸ìŠ¤ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤."))
  .then(result => alert(result)); // <-- .thenì—ì„œ resultë¥¼ ë‹¤ë£° ìˆ˜ ìˆìŒ
```

- ì˜ˆì‹œ
    
    ```jsx
    const getHen = () =>
      new Promise((resolve, reject) => {
        setTimeout(() => resolve("ğŸ“"), 1000);
      });
    
    const getEgg = (hen) =>
      new Promise((resolve, reject) => {
        setTimeout(() => resolve(`${hen} => ğŸ¥š`), 1000);
      });
    
    const cook = (egg) =>
      new Promise((resolve, reject) => {
        setTimeout(() => resolve(`${egg} => ğŸ³`), 1000);
      });
    
    getHen()
      .then((hen) => getEgg(hen)) // then(getEgg) ë¡œ ìƒëµê°€ëŠ¥
      .then((egg) => cook(egg))
      .then((meal) => console.log(meal));
    	.catch(console.log)
    	// ì¶œë ¥ê°’ ğŸ“ => ğŸ¥š => ğŸ³
    
    // ë§Œì•½ getEggì—ì„œ rejectê°€ ì„¤ì •ë˜ê³ , errorê°€ ë„˜ì–´ì˜¨ë‹¤ë©´
    getHen()
      .then(getEgg)
    	.catch(error => {
    		return 'ğŸ`
    	})
      .then(cook)
      .then(console.log)
    	.catch(console.log)
    	// ì¶œë ¥ê°’ ğŸ => ğŸ³ (ì¤‘ê°„ì— ì—ëŸ¬ ë°œìƒí–ˆì§€ë§Œ, catchë¡œ ëŒ€ì²´ê°’ ì„¤ì •í–ˆê¸°ì— ê°€ëŠ¥)
    	// ë§Œì•½ ì¤‘ê°„ì— catch ì—†ì—ˆë‹¤ë©´-> ì—ëŸ¬ë°œìƒí•˜ë©´ ìŠ¤í¬ë¦½íŠ¸ ì¦‰ì‹œ ì¤‘ë‹¨
    ```
    
    - ì½œë°±í•¨ìˆ˜ í˜¸ì¶œ ì‹œ, ë°›ì•„ì˜¤ëŠ” ì¸ìë¥¼ ë°”ë¡œ í•¨ìˆ˜ì— ë„£ëŠ” ê²½ìš°ë¼ë©´ ìƒëµ ê°€ëŠ¥
        
        `getHen().then((hen) => getEgg(hen))`
        
        â†’ `getHen().then(getEgg)`
        

## í”„ë¼ë¯¸ìŠ¤ API

---

- Promise.resolve & reject (async/ await ì „ êµ¬ì‹ ë°©ì‹)
    
    ë°”ë¡œ ì„±ê³µ/ì‹¤íŒ¨í•œ Promise ë°˜í™˜ â‡’ ì¸ìœ„ì ìœ¼ë¡œ í”„ë¼ë¯¸ìŠ¤ ë©”ì„œë“œ ì²´ì¸ ë§Œë“¤ ìˆ˜ ìˆìŒ
    

### Promise.all

`let promise = Promise.all([...promises...]);`

ì—¬ëŸ¬ ê°œì˜ í”„ë¼ë¯¸ìŠ¤ë¥¼ ë³‘ë ¬ë¡œ ì‹¤í–‰ â†’ ê²°ê³¼ê°’ì„ ë‹´ì€ ë°°ì—´ ë°˜í™˜ë¨

- í•˜ë‚˜ì˜ promiseë¼ë„ ì‹¤íŒ¨ â‡’ ì‹¤í–‰ë˜ì§€ ì•Šê³  ì—ëŸ¬ ë°˜í™˜
- ì‹¤í–‰ë˜ëŠ” ìˆœì„œê°€ ë‹¬ë¼ë„, ë°°ì—´ ìˆœìœ¼ë¡œ ê²°ê³¼ ë°˜í™˜

```jsx
function getAnimal(kind) {
	return new Promise(resolve => {
		setTimeout(() => {
			resolve(kind)
		}, 1000);
});

// ì¤‘ì²© ì‹¤í–‰(ì§ë ¬ ì‹¤í–‰) => ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ -> 2ì´ˆ ê±¸ë¦¼
getAnimal('cat')
	.then(cat => getAnimal('dog').then(dog => [cat, dog]));

// ìˆœì°¨ ì‹¤í–‰ -> 2ì´ˆ ê±¸ë¦¼
function getCatAndDog() {
	let cat = await getAnimal('cat');
	let dog = await getAnimal('dog');
	console.log([cat, dog]);
}
// Promise.all ì‚¬ìš©í•œ ë³‘ë ¬ ì‹¤í–‰ -> 1ì´ˆ ê±¸ë¦¼
Promise.all([getAnimal(cat), getAnimal(dog)])
	.then(pets => console.log(pets)) // = .then(console.log)
```

### Promise.allSettled

`let promise = Promise.allSettled([...promises...]);`

í”„ë¼ë¯¸ìŠ¤ë¥¼ ì‹¤í–‰í•œ ëª¨ë“  ê°’ ë°°ì—´ë¡œ ë°˜í™˜

- `Promise.all` ê³¼ ì°¨ì´ì  : ì—ëŸ¬ê°€ ë°œìƒí•´ë„ ì‹¤í–‰í•´ì„œ ê²°ê³¼ê°’ ë°˜í™˜
    - ì‘ë‹µì´ ì„±ê³µí•  ê²½ìš° â€“Â `{status:"fulfilled", value:result}`
    - ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš° â€“Â `{status:"rejected", reason:error}`
- catchëŠ” ì‚¬ìš© ë¶ˆê°€ ê·¸ëƒ¥ ëª¨ë‘ thenìœ¼ë¡œ ì‹¤í–‰í•˜ê³  ì—ëŸ¬ë„ í¬í•¨í•´ì„œ ë±‰ì–´ëƒ„

```jsx

async function getDrinks() {
  let coffee = await getCoffee();
  let tea = await getTea();
  return coffee + ' and ' + tea;
}
```

### Promise.race

`let promise = Promise.race([...promises...]);`

ëª¨ë“  í”„ë¼ë¯¸ìŠ¤ë¥¼ ì‹¤í–‰í•˜ê³ , ê°€ì¥ ë¨¼ì € ì²˜ë¦¬ë˜ëŠ” ê²°ê³¼(í˜¹ì€ ì—ëŸ¬)ë¥¼ ë°˜í™˜

### Promise.resolve / Promise.reject

resolveë‚˜ rejectë¥¼ ì¸ìë¡œ ë°›ì•„ì„œ ë”°ë¡œ ì²˜ë¦¬í•˜ì§€ ì•Šê³ , ë°”ë¡œ ì²˜ë¦¬

```jsx
if(number < 10) {
	return Promise.reject(new Error('10 ì´ìƒì˜ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'));
}
```

# async / await

promise ì²´ì´ë‹ì˜ syntactic sugar

## async

`async function fnc() { ~ };`

`async`ì´ ë¶™ì€ í•¨ìˆ˜ëŠ” í”„ë¼ë¯¸ìŠ¤ë¥¼ ë°˜í™˜

- ë™ê¸°ì ìœ¼ë¡œ ë³´ì´ì§€ë§Œ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰

ë‚´ë¶€ì—ì„œ await í‚¤ì›Œë“œê°€ ì“°ì´ì§€ ì•Šì•˜ì„ ê²½ìš°ì—” Promise.resolve() ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤.

- í”„ë¼ë¯¸ìŠ¤ê°€ ì•„ë‹Œ ê²ƒì€ í”„ë¼ë¯¸ìŠ¤ë¡œ ê°ì‹¸ ë°˜í™˜í•¨
    
    (returnê°’ ì—†ë‹¤ë©´ `Promise {<fulfilled>: undefined}` ë°˜í™˜)
    

```jsx
async function promise() {
		return 'jiwoo'; // promise {'jiwoo'} ë°˜í™˜
}

// ìœ„ì™€ ê°™ìŒ
function promise() {
	return new Promise((resolve, reject) => {
		resolve('jiwoo');
});
```

## await

`let value = await promise`

`promise.then`ì— ì—°ê²°í•œ ê²ƒì²˜ëŸ¼ ë¹„ë™ê¸°ì²˜ë¦¬ì— ìˆœì„œë¥¼ ë¶€ì—¬í•˜ê³ , ë°˜í™˜ê°’ì„ ë°›ìŒ

- `async` í•¨ìˆ˜ ì•ˆì—ì„œë§Œ ë™ì‘í•¨
- `try`, `catch`ë¥¼ ì´ìš©í•´ ì—ëŸ¬í•¸ë“¤ë§ ê°€ëŠ¥
    
    ex) `try {await fnc()} catch {~}`
    
- í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°˜í™˜í•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜ë¼ë„ ì‚¬ìš© ê°€ëŠ¥
    
    â‡’ `Promise.resolve()`ë¡œ ê°ì‹¸ì ¸ì„œ ì‹¤í–‰ë¨
    
- await ë¬¸ì€Â async í•¨ìˆ˜ì˜ ì‹¤í–‰ì„ ì¤‘ë‹¨ì‹œí‚¤ê³ , Promiseê°€Â fulfill(ì´í–‰)
Â orÂ reject(ê±°ì ˆ)Â ë˜ê¸° ì „ê¹Œì§€ ê¸°ë‹¤ë¦¼

```jsx
function delay(ms) {
	return new Promise(resolve => setTimeout(resolve, ms));
}

async function getApple() {
	await delay(3000); // 3ì´ˆ ê¸°ë‹¤ë¦¬ë‹¤ê°€ ì‚¬ê³¼ ì¶œë ¥
	return 'ğŸ`;
}

// ìœ„ì™€ ê°™ìŒ
function getApple() {
	return delay(3000) // 3ì´ˆë™ì•ˆ ê¸°ë‹¤ë¦¬ê³  í”„ë¼ë¯¸ìŠ¤ë¥¼ ë°›ì•„
						.then(() => 'ğŸ'); // ê²°ê³¼ê°’ì„ ë°›ì•„ì„œ return
}

// ì´ëŸ°ì‹ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥ (ì•„ë˜ ì„¸ í•¨ìˆ˜ëŠ” í”„ë¼ë¯¸ìŠ¤ë¥¼ ë°˜í™˜)
(async () => {
    const name = await getName();
    const age = await getAge();
    const address = await getAddress();

    console.log(name, age, address);
})();

// fetchë¡œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
async function bthClick() {
	let res = await fetch('https://randomuser.me/api/?password=upper,lower,number');
  let data = await res.json();

  h4.innerHTML = data;
}
```

### í”„ë¼ë¯¸ìŠ¤ vs sync, await

- Promise : ë©”ì†Œë“œ ì²´ì´ë‹ì´ ë§ì´ ì‚¬ìš©ë˜ëŠ” ì½”ë“œì— ì í•©
- sync&await : ê°œë³„ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ì„œ ë°›ì•„ì˜¤ëŠ” ì½”ë“œì— ì í•©
- í”„ë¼ë¯¸ìŠ¤ â†’ async / await
    
    ```jsx
    // 1. ì„¸ê°€ì§€ ë°ì´í„° ë°›ì•„ì˜¤ê¸°
    // (get ì„¸í•¨ìˆ˜ ëª¨ë‘ í”„ë¼ë¯¸ìŠ¤ ë°˜í™˜)
    
    // í”„ë¼ë¯¸ìŠ¤ ì‚¬ìš©
    Promise
        .all([getName(), getAge(), getAddress()])
        .then((res) => {
            const [name, age, address] = res;
            console.log(name, age, address)
        })
    
    // async & await ì‚¬ìš©
    // ë³‘ë ¬ì ìœ¼ë¡œ ì‹¤í–‰ì‹œì¼œ 
    (async () => {
        const name = await getName();
        const age = await getAge();
        const address = await getAddress();
    
        console.log(name, age, address);
    })();
    
    // 2.
    function delay(ms) {
      return new Promise((resolve) => setTimeout(resolve, ms));
    }
    
    async function getApple() {
      await delay(2000); // 3ì´ˆ ê¸°ë‹¤ë¦¬ë‹¤ê°€ ì‚¬ê³¼ ì¶œë ¥
      return "ğŸ";
    }
    
    async function getBanana() {
      await delay(2000); // 3ì´ˆ ê¸°ë‹¤ë¦¬ë‹¤ê°€ ì‚¬ê³¼ ì¶œë ¥
      return "ğŸŒ";
    }
    
    // í”„ë¼ë¯¸ìŠ¤ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
    function pickFruits() {
      return getApple().then((apple) => {
        return getBanana().then((banana) => `${apple} + ${banana}`);
      });
    }
    
    // async, await ì‚¬ìš© ë°©ë²•
    // => ì§ë ¬ì‹ ë°©ì‹ì´ë¼ appleì´ ì‹¤í–‰ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê³ , bananaì—ì„œ ë©ˆì¶°ì„œ 4ì´ˆê°€ ê±¸ë¦¼
    async function pickFruits() {
      let apple = await getApple();
      let banana = await getBanana();
    
      return `${apple} + ${banana}`;
    }
    
    pickFruits().then(console.log);
    ```
    
    1. ë¨¼ì €Â `.then`Â í˜¸ì¶œì„Â `await`ë¡œ ë°”ê¾¸ê¸°
    2. function ì•ì—Â `async`ë¥¼ ë¶™ì—¬Â `await`ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•¨
    - ë³‘ë ¬ì‹ìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¤ê¸°
        
        ```jsx
        // ë³‘ë ¬ì ìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¤ê¸° (ë™ì‹œì— ì‹¤í–‰ë˜ì„œ 2ì´ˆ ê±¸ë¦¼)
        async function pickFruits() {
        	let applePromise = getApple(); // ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ì¦‰ì‹œ ì‹¤í–‰ë˜ì–´ í”„ë¼ë¯¸ìŠ¤ ë°˜í™˜ 
        	let bananaPromise = getBanana();
        ```
        

# fetch

- (êµ¬ë°©ì‹) AJAX
    
    ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¸Œë¼ìš°ì €ê°€ ì„œë²„ì—ê²Œ ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ìš”ì²­í•˜ê³ , ì„œë²„ê°€ ì‘ë‹µí•œ ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•˜ì—¬ ì›¹í˜ì´ì§€ë¥¼ ë™ì ìœ¼ë¡œ ê°±ì‹ í•˜ëŠ” í”„ë¡œê·¸ë˜ë° ë°©ì‹
    
    - XHR(XMLHttpRequest) : HTTP ìš”ì²­ì„ í•  ìˆ˜ ìˆëŠ” ë‚´ì¥ ë¸Œë¼ìš°ì € ê°ì²´ (XML í˜•ì‹ ë¿ë§Œ ì•„ë‹ˆë¼ ëª¨ë“  ë°ì´í„°ì—ì„œ ì‘ë™ ê°€ëŠ¥)
    - XML : htmlê³¼ ê°™ì€ ë§ˆí¬ì—… ì–¸ì–´, ë³´ì—¬ì£¼ê¸°ê°€ ì•„ë‹ˆë¼ ë°ì´í„° ì „ë‹¬ì´ ì£¼ ëª©ì 
    
    ![xhrë¡œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” êµ¬ì‹ë°©ì‹](Asynchronous%20Programming%2080a4a4ad358a4f9ea5a46837769d0193/Untitled%202.png)
    
    xhrë¡œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” êµ¬ì‹ë°©ì‹
    

![Untitled](Asynchronous%20Programming%2080a4a4ad358a4f9ea5a46837769d0193/Untitled%203.png)

`let promise = fetch('url', [options])`

urlì„ í†µí•´ ë¸Œë¼ìš°ì €ì— ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì„ ë³´ë‚´ê³ , **í”„ë¼ë¯¸ìŠ¤ ë°˜í™˜** (ì£¼ë¡œ JSON ë°ì´í„°)

- `â€˜**url'**`Â â€“ ì ‘ê·¼í•˜ê³ ì í•˜ëŠ” URL
    - ê°™ì€ í´ë”ì˜ íŒŒì¼ì´ë¼ë©´ `'íŒŒì¼ëª….í™•ì¥ì'`
- **`options`**Â â€“ ì„ íƒ ë§¤ê°œë³€ìˆ˜, methodë‚˜ header ë“±ì„ ì§€ì •í•  ìˆ˜ ìˆìŒ
    
    (ìƒëµì‹œ ìš”ì²­ì€ GETë©”ì„œë“œë¡œ ì§„í–‰ â‡’ urlë¡œë¶€í„° ì½˜í…ì¸  ë‹¤ìš´ë¡œë“œë¨)
    

```jsx
// res, data ë“± ë³€ìˆ˜ ì´ë¦„ì€ ììœ ë¡­ê²Œ ì •í•©ë‹ˆë‹¤.
fetch('data.json')
  .then(res => res.json())
  .then(data => console.log(data)); // ë°ì´í„° ê°€ì ¸ì™€ì„œ ì¶œë ¥

let response = await fetch('data.json');
console.log(response.json());

// ì˜µì…˜ ì§€ì •
fetch(" https://reqres.in/api/users", {
  method: "POST",
  headers: {'Content-type': 'application/json'},
  body: JSON.stringify({ name: 'ì²«ë²ˆì§¸ ì°¸ê°€ì'}),
})
  .then((res) => {
    if(res.ok) {
        console.log('Success!');
        return res.json();
    } else console.log(failed);
  })
  .then((data) => console.log(data))
  .catch((error) => console.log("Error"));
```

## Response

---

`let response = await fetch(url[, option]);`

fetch í˜¸ì¶œë¡œ ë°˜í™˜ë°›ì€ promiseì˜ ì‘ë‹µ ê°ì²´ (ê²°ê³¼ê°’)

![Untitled](Asynchronous%20Programming%2080a4a4ad358a4f9ea5a46837769d0193/Untitled%204.png)

- url : `ë°ì´í„° ì£¼ì†Œ` or ë°ì´í„° ë°›ì•„ì˜¬ `íŒŒì¼ëª….í™•ì¥ì`
- option : method í•„ë“œë¡œ ì—¬ëŸ¬ ìš”ì²­ ë©”ì„œë“œë¥¼ í™œìš© ê°€ëŠ¥
    
    (header, body í•„ë“œë¡œ ì„œë²„ì— ì¶”ê°€ ì •ë³´ ë³´ëƒ„)
    

### HTTP ìƒíƒœ ë°›ëŠ” í”„ë¡œí¼í‹°

- `response.ok` - HTTPìƒíƒœ ì½”ë“œê°€ 200~299 : true / ì´ì™¸ false
- `response.status` - HTTP ìƒíƒœ ì½”ë“œ
- `response.url` - ìš”ì²­í•œ URL ì •ë³´ ë‹´ìŒ

### ë³¸ë¬¸ ë°›ì•„ì˜¤ëŠ” ë©”ì„œë“œ

ë³¸ë¬¸ ë©”ì„œë“œëŠ” ë”± í•˜ë‚˜ë§Œ ì‚¬ìš© ê°€ëŠ¥

- `response.text()`Â â€“ ì‘ë‹µì„ ì½ê³  í…ìŠ¤íŠ¸ë¥¼ ë°˜í™˜
- `response.json()`Â â€“ ì‘ë‹µì„ JSONìœ¼ë¡œ ë§Œë“œëŠ” promise ë°˜í™˜
- `response.formData()`Â â€“ ì‘ë‹µì„Â `FormData`Â ê°ì²´ í˜•íƒœë¡œ ë°˜í™˜
- `response.blob()`Â â€“ ì‘ë‹µì„Â Blob(íƒ€ì…ì´ ìˆëŠ” ë°”ì´ë„ˆë¦¬ ë°ì´í„°) í˜•íƒœë¡œ ë°˜í™˜
- `response.arrayBuffer()`Â â€“ ì‘ë‹µì„Â ArrayBuffer(ë°”ì´ë„ˆë¦¬ ë°ì´í„°ë¥¼ ë¡œìš° ë ˆë²¨ í˜•ì‹ìœ¼ë¡œ í‘œí˜„í•œ ê²ƒ) í˜•íƒœë¡œ ë°˜í™˜?

### í—¤ë” ì‘ë‹µ

`response.headers` - Response ê°ì²´ì˜ í—¤ë” ì •ë³´ ë°˜í™˜

## API ë¶ˆëŸ¬ì˜¤ê¸°

---

### 1. API url ì¤€ë¹„

- ì˜ˆì‹œ
    
    [weather API ë°›ê¸°](http://openweathermap.org/) : openweathermap.org
    
    (ë‚´ API_KEY: 9fa4320ce0f2af5804626dcb41e2a97e )
    
    ![https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/c8d5399ff54047bdaf4446f1f27d60e6/0b150870-8728-462f-af03-69c40b3e5619.png](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_images/c8d5399ff54047bdaf4446f1f27d60e6/0b150870-8728-462f-af03-69c40b3e5619.png)
    
    ![https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_markup_images/c8d5399ff54047bdaf4446f1f27d60e6/807b8bfe-1d62-4538-96be-52ac4eac3bde.png](https://slid-capture.s3.ap-northeast-2.amazonaws.com/public/capture_markup_images/c8d5399ff54047bdaf4446f1f27d60e6/807b8bfe-1d62-4538-96be-52ac4eac3bde.png)
    

### 2. fetch API

1. `fetch(url)` : urlì˜ objë¥¼ jsë¡œ ê°€ì ¸ì˜¨ë‹¤
2. `.then` ì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ìŒ í–‰ë™ ì§€ì •

```jsx
function onGeoOk(position) {
  const API_KEY = "9fa4320ce0f2af5804626dcb41e2a97e";
  const lat = position.coords.latitude;
  const lon = position.coords.longitude;
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${API_KEY}&units=metric`;
  fetch(url)
    .then((response) => response.json())
    .then((data) => {
      const weather = data.weather[0].main;
			const temperature = data.main.temp;
      const city = data.name;
      console.log(`${city} ${weather} ${temperature}`;
			// seoul clouds 16  ì´ë ‡ê²Œ ì¶œë ¥
    });
}
```

### 2-2. axios ì´ìš©

[https://github.com/axios/axios](https://github.com/axios/axios)

1. (html) headì— Using unpkg CDN ë¶™ì—¬ë„£ê¸°
    
    `<script src="[https://unpkg.com/axios/dist/axios.min.js](https://unpkg.com/axios/dist/axios.min.js)"></script>`
    
2. (js) `axios.get('API url').then((res) â‡’ ë™ì‘ ì§€ì •)`
    
    ```jsx
    axios.get('API url')
      .then(function (response) {
        // handle success
        console.log(response);
      })
      .catch(function (error) {
        // handle error
        console.log(error);
      })
      .then(function () {
        // always executed
      });
    ```
    

# ì—ëŸ¬í•¸ë“¤ë§

ì—ëŸ¬ ë°œìƒì‹œ, ìŠ¤í¬ë¦½íŠ¸ê°€ ì¤‘ë‹¨ë˜ê³  ì—ëŸ¬ê°€ ì¶œë ¥ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ëŠ” ë¬¸ë²•

```jsx
try {

  // ì½”ë“œ...

} catch (err) { // err : ì—ëŸ¬ ê°ì²´(ì¸ì)

  // ì—ëŸ¬ í•¸ë“¤ë§

} finally { // ìƒëµ ê°€ëŠ¥

	// í•­ìƒ ì‹¤í–‰
}
```

1. `try {~}` ì•ˆì˜ ì½”ë“œ ì‹¤í–‰
2. ì—ëŸ¬ê°€ ì—†ë‹¤ë©´, `catch` ë¸”ë¡ ê±´ë„ˆëœ€
3. ì—ëŸ¬ê°€ ìˆë‹¤ë©´, ì½”ë“œê°€ ì¤‘ë‹¨ë˜ê³  catch ë¸”ë¡ ì‹¤í–‰
4. (ìƒëµ ê°€ëŠ¥) `finally` ë¸”ë¡ ì‹¤í–‰
ì„±ê³µ ì—¬ë¶€ì— ìƒê´€ì—†ì´ / returnìœ¼ë¡œ ë¹ ì ¸ë‚˜ê°€ë„ ì‹¤í–‰
- ìœ íš¨í•œ ì½”ë“œì—ì„œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ë§Œ ì²˜ë¦¬ ê°€ëŠ¥ (ê´„í˜¸ í•˜ë‚˜ê°€ ì—†ê±°ë‚˜ ì•„ì˜ˆ ììŠ¤ê°€ ì´í•´ëª»í•˜ëŠ” ì½”ë“œëŠ” ë¶ˆê°€)

### ì—ëŸ¬ ê°ì²´

ì—ëŸ¬ ë°œìƒì‹œ catchì— ì „ë‹¬ë˜ëŠ” ê°ì²´ ì¸ì (í•„ìš” ì—†ìœ¼ë©´ ìƒëµ ê°€ëŠ¥)

- ì£¼ìš” í”„ë¡œí¼í‹°
    - name : ì—ëŸ¬ ì´ë¦„ (ì •ì˜ë˜ì§€ ì•Šì€ ë³€ìˆ˜ ì—ëŸ¬ë¼ë©´ `ReferenceError`)
    - message : ì—ëŸ¬ì˜ ìƒì„¸ ë‚´ìš©
    - stack : (í‘œì¤€ì€ ì•„ë‹ˆì§€ë§Œ ëŒ€ë¶€ë¶„ ì§€ì›) í˜„ì¬ í˜¸ì¶œ ìŠ¤íƒ. ì—ëŸ¬ë¥¼ ìœ ë°œí•œ ì¤‘ì²© í˜¸ì¶œë“¤ì˜ ìˆœì„œ ì •ë³´ë¥¼ ê°€ì§„ ë¬¸ìì—´ë¡œ ë””ë²„ê¹… ëª©ì ìœ¼ë¡œ ì‚¬ìš©

```jsx
try {
  lalala; // ì—ëŸ¬, ë³€ìˆ˜ê°€ ì •ì˜ë˜ì§€ ì•ŠìŒ!
} catch(err) {
  alert(err.name); // ReferenceError
  alert(err.message); // lalala is not defined
  alert(err.stack); // ReferenceError: lalala is not defined at ... (í˜¸ì¶œ ìŠ¤íƒ)

  // ì—ëŸ¬ ì „ì²´ ë³´ê¸° ê°€ëŠ¥ ("name: message" í˜•íƒœì˜ ë¬¸ìì—´)
  alert(err); // ReferenceError: lalala is not defined
}
```

### ì§ì ‘ ì—ëŸ¬ ë§Œë“¤ê¸°

1. ì§ì ‘ ì—ëŸ¬ ê°ì²´ ìƒì„± : `throw <error object>`
    - ì—ëŸ¬ ê°ì²´ì— name, message í”„ë¡œí¼í‹° ê¼­ ë„£ì„ ê²ƒ
2. ì—ëŸ¬ ê°ì²´ ìƒì„±ì ì‚¬ìš© : `throw new ìƒì„±ì(message)`
    - ë‚´ì¥ ì—ëŸ¬ ê°ì²´ì˜ name í”„ë¡œí¼í‹°ëŠ” ìƒì„±ì ì´ë¦„ê³¼ ë™ì¼í•œ ê°’
    - ìƒì„±ì ì¢…ë¥˜
        - `Error`
        - `SyntaxError`
        - `ReferenceError`

### ì—ëŸ¬ ë‹¤ì‹œ ë˜ì§€ê¸° (throw)

catch ì•ˆì—ì„œ throw â†’ ìƒìœ„ catchë¡œ ë„˜ì–´ê° or ë‹¤ìŒ catchë¡œ ë„˜ì–´ê°

- throw í•˜ëŠ” ì´ìœ 
    
    errorê°€ catchì—ì„œ í•œ ë²ˆ ì²˜ë¦¬ë˜ë©´, ë‹¤ìŒ ìƒìœ„ catchë¡œ ë„˜ì–´ê°€ì§€ ì•ŠìŒ
    
    â†’ ì—ëŸ¬ì˜ ì¢…ë¥˜ì™€ëŠ” ìƒê´€ì—†ì´ ì¼ë¥ ì ìœ¼ë¡œ ì²˜ë¦¬í•´ì„œ ì–´ë–¤ ì—ëŸ¬ì¸ì§€ ì •í™•íˆ ì•Œì§€ ëª»í•˜ëŠ” ê²½ìš° ë°œìƒ
    
    â‡’ catchëŠ” ìê¸°ê°€ ì•„ëŠ” ì—ëŸ¬ê°€ ì•„ë‹ˆë©´ ë‹¤ì‹œ ë˜ì ¸ì•¼í•¨ 
    
1. **ìƒìœ„ì˜ catchì—ì„œ ë°›ê¸°**

![Untitled](Asynchronous%20Programming%2080a4a4ad358a4f9ea5a46837769d0193/Untitled%205.png)

1. **catchì—ì„œ ë‹¤ìŒ catchë¡œ ì—ëŸ¬ ë„˜ê¸°ê¸°**
    1. catchê°€ ëª¨ë“  ì—ëŸ¬ ë°›ìŒ
    2. `catch(err) {...}`ì—ì„œ ì—ëŸ¬ ê°ì²´ë¥¼ ë¶„ì„ â‡’ ë³´í†µ `instanceof`ë¡œ ì²´í¬
    3. ì—ëŸ¬ ì²˜ë¦¬ ë°©ë²•ì„ ëª¨ë¥´ë©´ ë‹¤ì‹œ `throw error` í•˜ê¸°

# í˜¸ì¶œìŠ¤ì¼€ì¤„ë§

## ë©”ì„œë“œ

---

### **setTimeout**

`setTimeout(func|code, [delay, arg1, arg2, ...])`

fncì´ n(ms) í›„ì— ì‹¤í–‰ (1ë²ˆ), ì¸ìë„ ì „ë‹¬ ê°€ëŠ¥

- fncëŠ” ì‹¤í–‰í•˜ì§€ ì•Šê³  ì „ë‹¬í•  ê²ƒ
    
    ex) `setTimeout(() => ~, ms)` / `setTimeout(fnc, ms)`
    
- ì¢…ë£Œ: `clearTimeout(fnc)` or `reset(ë³€ê²½í•œìš”ì†Œ)`
- ì½œë°± ì§€ì˜¥ì´ ë˜ëŠ” ì˜ˆì‹œ
    
    1ì´ˆì— ì•„ë©”ë¦¬ì¹´ë…¸ â†’ 2ì´ˆ í›„ ì¹´ë¼ë©œ í”„ë¼í‘¸ì¹˜ê³  â†’ 3ì´ˆ í›„ 
    
    ```jsx
    const orderCoffee = (menu) => {
        console.log(`${menu} ë‚˜ì™”ìŠµë‹ˆë‹¤.`);
    };
    
    setTimeout(() => {
        orderCoffee('ì•„ë©”ë¦¬ì¹´ë…¸');
    }, 1000);
    
    setTimeout(() => {
        orderCoffee('ì¹´ë¼ë©œ í”„ë¼í‘¸ì¹˜ë…¸');
    }, 2000);
    
    setTimeout(() => {
        orderCoffee('ì¹´í˜ë¼ë–¼');
    }, 3000);
    
    // ìœ„ í•¨ìˆ˜ ì¤‘ì²©í•œ ê²ƒ -> ì½œë°±ì§€ì˜¥
    const orderCoffee = (menu) => {
        console.log(`${menu} ë‚˜ì™”ìŠµë‹ˆë‹¤.`);
    };
    
    setTimeout(() => {
        orderCoffee("ì•„ë©”ë¦¬ì¹´ë…¸",
            setTimeout(() => {
                orderCoffee("ì¹´ë¼ë©œ í”„ë¼í‘¸ì¹˜ë…¸", 
                    setTimeout(() => {
                        orderCoffee("ì¹´ë ˆë¼ë–¼")
                },1000))
            }, 1000));
    }, 1000);
    ```
    

### **setInterval**

`let timerId = setInterval(func|code, [delay, arg1, arg2, ...])`

fncì´ n(ms)ë§ˆë‹¤ ì‹¤í–‰ (1000ms = 1s(ì´ˆ))

- ì¤‘ë‹¨ : `clearInterval(fnc)`or `reset(ë³€ê²½í•œìš”ì†Œ)`
- ì¬ì‹œì‘ : ë³€ìˆ˜ì— setInterval ì¬í• ë‹¹
    
    

## ì›¹ì—ì„œ ì´ë²¤íŠ¸ ì œì–´í•˜ê¸°

---

### ë””ë°”ìš´ì‹±

ì—°ì´ì–´ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ë“¤ ì¤‘ ë§ˆì§€ë§‰ í•¨ìˆ˜(or ì²« í•¨ìˆ˜)ë§Œ í˜¸ì¶œí•˜ëŠ” ê²ƒ

â‡’ ê²€ìƒ‰ì–´ ì…ë ¥ ì¤‘ì— ê²°ê³¼ í‘œì‹œ & ê·¸ë ‡ë‹¤ê³  ë„ˆë¬´ ìì£¼ í•¨ìˆ˜ ì‹¤í–‰ ë§‰ê¸° ì— ì£¼ë¡œ ì‚¬ìš©ë¨

```jsx
let input = document.querySelector('#input');

// ê¸°ë³¸ í•¨ìˆ˜ í˜•íƒœ
input.addEventListener('input', function(e) {
  console.log('ì—¬ê¸°ì— ajax ìš”ì²­', e.target.value);
});

// ë””ë°”ìš´ì‹±
var timer; // 1. íƒ€ì´ë¨¸ ìƒì„± (ì´ë²¤íŠ¸ë¦¬ìŠ¤í„° ë°”ê¹¥ì—)
input.addEventListener('input', function(e) {
  if (timer) { // 3
    clearTimeout(timer);
  }
  timer = setTimeout(function() {
    console.log('ì—¬ê¸°ì— ajax ìš”ì²­', e.target.value);
  }, 200); // 2
});
```

1. íƒ€ìë¥¼ ì¹  ë•Œ íƒ€ì´ë¨¸ ì„¤ì •
2. 200msë™ì•ˆ ì…ë ¥ì´ ì—†ìœ¼ë©´ ì…ë ¥ì´ ëë‚¬ë‹¤ê³  ì¸ì‹
3. 200msì´ì „ì— ì…ë ¥ì´ ë°œìƒí•˜ë©´ ì´ì „ íƒ€ì´ë¨¸ ì‚­ì œí•˜ê³  ë‹¤ì‹œ íƒ€ì´ë¨¸ ì„¤ì •

### ì“°ë¡œí‹€ë§

ë§ˆì§€ë§‰ í•¨ìˆ˜ê°€ í˜¸ì¶œëœ í›„ ì¼ì • ì‹œê°„ì´ ì§€ë‚˜ê¸° ì „ì— ë‹¤ì‹œ í˜¸ì¶œë˜ì§€ ì•Šë„ë¡ í•˜ëŠ” ê²ƒ

â‡’ ìŠ¤í¬ë¡¤í•  ë•Œ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜ì˜ ì‹¤í–‰ íšŸìˆ˜ë¥¼ ì œí•œí•  ë•Œ ì£¼ë¡œ ì‚¬ìš©

```jsx
var timer;
input.addEventListener('input', function (e) {
  if (!timer) {
    timer = setTimeout(function() {
      timer = null;
      console.log('ì—¬ê¸°ì— ajax ìš”ì²­', e.target.value);
    }, 200); // 200msë§ˆë‹¤ í•¨ìˆ˜ ì‹¤í–‰
  }
});
```

# JSON

ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ê°€ì¥ ê°„ë‹¨í•œ ë°ì´í„° í˜•íƒœ (JavaScript Object Notation)

1. key - value ìŒì˜ í˜•íƒœ
2. ì„œë²„ì™€ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ì„ ë•Œ ì§ë ¬í™”ë¥¼ ìœ„í•´ ì‚¬ìš©ë¨
3. í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë‚˜ í”Œë«í¼ì— ìƒê´€ì—†ì´ ì‚¬ìš© ê°€ëŠ¥
- ì‚¬ìš© ì´ìœ 
    
    ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ê°ì²´ë‚˜ ê°’ì„ ì „ë‹¬í•˜ë ¤ë©´ ê°ì²´ë¥¼ ë¬¸ìì—´ë¡œ ì „í™˜í•´ì•¼ í•˜ëŠ”ë°, ì •ë³´ê°€ ë‹´ê¸´ í”„ë¡œí¼í‹°ê°€ í¬í•¨ëœ ìƒíƒœë¡œ ì „í™˜í•´ì•¼í•¨
    â†’ ê·¸ëƒ¥ ë¬¸ìì—´ë¡œ ë°”ê¾¸ë©´ ì •ë³´ ë‚ ì•„ê°€ëŠ” ê²½ìš° ìˆìœ¼ë¯€ë¡œ **JSON** êµ¬í˜„
    

---

## JSON.stringify

`JSON.stringify(value[, replacer[, space]])`

ê°ì²´ â†’ JSON

- value : ì¸ì½”ë”©í•  ê°ì²´
- ì´ë ‡ê²Œ ë³€ê²½ëœ ë¬¸ìì—´ì€ JSONìœ¼ë¡œ ì¸ì½”ë”©ëœ(JSON-encoded), ì§ë ¬í™” ì²˜ë¦¬ëœ(serialized), ë¬¸ìì—´ë¡œ ë³€í™˜ëœ(stringified), ê²°ì§‘ëœ(marshalled) ê°ì²´ë¼ê³  ë¶ˆë¦¼

```jsx
let student = {
  name: 'John',
  age: 30,
  isAdmin: false,
  courses: ['html', 'css', 'js'],
  wife: null,
	birth: new Date(),
	jump: () => {
		console.log('jump!');
	},
};

alert(JSON.stringify(student));
/*
{
  "name":"John",
  "age":30,
  "isAdmin":false,
  "courses":["html", "css", "js"],
  "wife":null
	"birth":"2022-09-07T13:20:22.670Z"
}
*/
```

1. `type of JSON` = string
2. ë¬¸ìì—´ or ê°ì²´ í”„ë¡œí¼í‹° â‡’  `â€œ â€`ë¡œ ê°ì‹¸ì§ (`â€™`, ``` x)

1. ì „í™˜ ê°€ëŠ¥ ìë£Œí˜•
    - (ì°¸ì¡°í˜•) ê°ì²´, ë°°ì—´
    - (ì›ì‹œí˜•) ë¬¸ì, ìˆ«ì, boolean, null

1. ë¬´ì‹œë˜ëŠ” í”„ë¡œí¼í‹°
    - í•¨ìˆ˜ í”„ë¡œí¼í‹°(ë©”ì„œë“œ)
    - í‚¤ê°€ ì‹¬ë³¼ì¸ í”„ë¡œí¼í‹°
    - ê°’ì´ undefinedì¸ í”„ë¡œí¼í‹°
1. ì¤‘ì²© ê°ì²´ë„ ë¬¸ìì—´ë¡œ ë°”ê¿”ì¤Œ
- ìˆœí™˜ ì°¸ì¡°ê°€ ìˆìœ¼ë©´ ë¬¸ìì—´ ë³€í™˜ ë¶ˆê°€ëŠ¥
    
    ```jsx
    let room = {
      number: 23
    };
    
    let meetup = {
      title: "Conference",
    };
    
    meetup.place = room;       // meetupì€ roomì„ ì°¸ì¡°
    room.occupiedBy = meetup; // roomì€ meetupì„ ì°¸ì¡°
    
    JSON.stringify(meetup); // Error: Converting circular structure to JSON
    ```
    

### replacer

`JSON.stringify(value[, replacer[, space]])`

ì¸ì½”ë”© ì›í•˜ëŠ” í”„ë¡œí¼í‹°ê°€ ë‹´ê¸´ ë°°ì—´ or ë§¤í•‘ í•¨ìˆ˜ë¡œ JSONì„ ì„¸ì‹¬í•˜ê²Œ í†µì œ ê°€ëŠ¥

1. **ì¸ì½”ë”© ì›í•˜ëŠ” í”„ë¡œí¼í‹°ê°€ ë‹´ê¸´ ë°°ì—´**
    
    `JSON.stringify(value, ['prop', 'prop' â€¦])`
    
    ```jsx
    let person = {
    	name: 'jw',
    	age: 12,
    }
    
    console.log(JSON.stringify(person, ['name']));
    // {"name":"jw"}
    ```
    
    - ì¸ì½”ë”© ë  ê°’ì´ ê°ì²´ë¼ë©´, í•´ë‹¹ ê°ì²´ì˜ í”„ë¡œí¼í‹°ë„ ë„£ì–´ì•¼ ì¶œë ¥ë¨
        
        ```jsx
        let room = {
          number: 23
        };
        
        let meetup = {
          title: "Conference",
          participants: [{name: "John"}, {name: "Alice"}],
          place: room // meetup references room
        };
        
        room.occupiedBy = meetup; // room references meetup
        
        alert( JSON.stringify(meetup, ['title', 'participants']) );
        // {"title":"Conference","participants":[{},{}]}
        // participantsì˜ ê°’ì¸ ê°ì²´ì˜ í”„ë¡œí¼í‹°ë¥¼ ì¨ì£¼ì§€ ì•Šì•„ì„œ ê°’ ëª» ë¶ˆëŸ¬ì˜´
        
        alert( JSON.stringify(meetup, ['title', 'participants', 'place', 'name', 'number']) );
        /*
        {
          "title":"Conference",
          "participants":[{"name":"John"},{"name":"Alice"}],
          "place":{"number":23}
        }
        */
        // ì´ë ‡ê²Œ ì°¸ì¡°ê°’ê¹Œì§€ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŒ. í•¨ìˆ˜ ì‚¬ìš©í•˜ë©´ ë‹¨ìˆœí™” ê°€ëŠ¥.
        ```
        
    
2. **ë§¤í•‘ í•¨ìˆ˜**
    
    `JSON.stringify(value, (key[, value]) => {~})`
    
    - ë°˜í™˜ê°’ â‡’ ê¸°ì¡´ì˜ ê°’ ë°˜í™˜í•˜ëŠ” í˜•íƒœë¡œ ì„¤ì • (`key : value`)
        
        ëˆ„ë½ì‹œí‚¬ í”„ë¡œí¼í‹°ëŠ” `undefined` ë°˜í™˜
        
    - ì¤‘ì²© ê°ì²´, ë°°ì—´ì˜ ìš”ì†Œê¹Œì§€ í¬í•¨í•œ ëª¨ë“  í‚¤-ê°’ ìŒ ì²˜ë¦¬
    - í•¨ìˆ˜ ë‚´ `this` â‡’ í˜„ì¬ ì²˜ë¦¬ì¤‘ì¸ í”„ë¡œí¼í‹°ì˜ ê°ì²´
    
    ```jsx
    let room = {
      number: 23
    };
    
    let meetup = {
      title: "Conference",
      participants: [{name: "John"}, {name: "Alice"}],
      place: room // meetupì€ roomì„ ì°¸ì¡°
    };
    
    room.occupiedBy = meetup; // roomì€ meetupì„ ì°¸ì¡°
    
    alert( JSON.stringify(meetup, (key, value) => {
      alert(`${key}: ${value}`); // ê¸°ì¡´ ë°˜í™˜ í˜•íƒœ
      return (key == 'occupiedBy') ? undefined : value;
    }));
    
    /* replacer í•¨ìˆ˜ì—ì„œ ì²˜ë¦¬í•˜ëŠ” í‚¤:ê°’ ìŒ ëª©ë¡
    :             [object Object]
    title:        Conference
    participants: [object Object],[object Object]
    0:            [object Object] (ë°°ì—´ì˜ ìš”ì†Œê¹Œì§€ í‚¤-ê°’ìœ¼ë¡œ ì²˜ë¦¬)
    name:         John
    1:            [object Object]
    name:         Alice
    place:        [object Object]
    number:       23
    */
    ```
    
    - ì²˜ìŒì— `":[object Object]"` ì´ ëœ¨ëŠ” ì´ìœ 
        
        í•¨ìˆ˜ê°€ ìµœì´ˆë¡œ í˜¸ì¶œì‹œ `{"": obj}` í˜•íƒœì˜ "[ë˜í¼ ê°ì²´](https://includestdio.tistory.com/26)"ê°€ ë§Œë“¤ì–´ì§€ê¸° ë•Œë¬¸
        

### space

ì¤‘ê°„ì— ì‚½ì…í•  ê³µë°± ë¬¸ììˆ˜ (ê°€ë…ì„±â†‘ ëª©ì )

â‡’ në§Œí¼ ë“¤ì—¬ì“°ê¸° & ì¤‘ì²© ê°ì²´ ë³„ë„ì˜ ì¤„ì— ì¶œë ¥

```jsx
let user = {
  name: "John",
  age: 25,
  roles: {
    isAdmin: false,
    isEditor: true
  }
};

alert(JSON.stringify(user, null));
// {"name":"John","age":25,"roles":{"isAdmin":false,"isEditor":true}}

alert(JSON.stringify(user, null, 2));
/* ê³µë°± ë¬¸ì ë‘ ê°œë¥¼ ì‚¬ìš©í•˜ì—¬ ë“¤ì—¬ì“°ê¸°í•¨:
{
  "name": "John",
  "age": 25,
  "roles": {
    "isAdmin": false,
    "isEditor": true
  }
}
*/
```

### toJSON

ê°ì²´ì— `toJSON`ì´ë¼ëŠ” ë©”ì„œë“œê°€ êµ¬í˜„ë˜ì–´ ìˆìœ¼ë©´ `JSON.stringify`ëŠ” ì´ë¥¼ ê°ì§€í•˜ê³  ìë™ìœ¼ë¡œ ë©”ì„œë“œ í˜¸ì¶œ

- ì§ì ‘ ë©”ì„œë“œ ì¶”ê°€í•´ì„œ ì»¤ìŠ¤í…€ë„ ê°€ëŠ¥

```jsx
let room = {
  number: 23,
	toJSON() { // ì§ì ‘ ë©”ì„œë“œ ì¶”ê°€
    return this.number;
  }
};

let meetup = {
  title: "Conference",
  date: new Date(Date.UTC(2017, 0, 1)), // Dateê°ì²´ì— ë‚´ì¥ ë©”ì„œë“œ toJSON ìˆìŒ
  room
};

alert( JSON.stringify(meetup) );
/*
  {
    "title":"Conference",
    "date":"2017-01-01T00:00:00.000Z",  // toJSON í˜¸ì¶œ -> dateê°’ì´ ë¬¸ìì—´ë¡œ ë³€í™˜
    "room": 23  // ì»¤ìŠ¤í…€ toJSON í˜¸ì¶œ -> room.number í˜¸ì¶œ
		// roomì— toJSON ì—†ë‹¤ë©´, "room": {"number":23}
  }
*/
```

---

## JSON.parse

`JSON.parse(str[, reviver])`

JSON â†’ ê°ì²´ ( ë¬¸ìì—´ì„ ë°°ì—´, ê°ì²´ë¡œ ë°›ì„ ë•Œ ì£¼ë¡œ ì‚¬ìš©)

### **str**

JSON í˜•ì‹ì˜ ë¬¸ìì—´

```jsx
// ë‹¨ìˆœ ë°°ì—´
let numbers = "[0, 1, 2, 3]";

alert(JSON.parse(numbers)[1]); // 1

// ì¤‘ì²© ê°ì²´
let userData = '{ "name": "John", "age": 35, "isAdmin": false, "friends": [0,1,2,3] }';

alert( JSON.parse(userData).friends[1] ); // 1
```

### **reviver**

`JSON.parse(str, (key[, value]) => {~})`

ëª¨ë“  (key, value)ìŒì— í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ê°’ ë³€ê²½ í›„, ë°˜í™˜

(ì „ë‹¬ë°›ì€ JSONê°’ì— ë³€í˜•ì´ í•„ìš”í•œ ê²½ìš° ì‚¬ìš©)

```jsx
// 1. ë‹¨ìˆœ ê°’ ë³€ê²½í•˜ê¸°
JSON.parse('{"p": 5}', (key, value) =>
  typeof value === 'number'
    ? value * 2 : value 
); // return { p: 10 }

// 2. ë©”ì„œë“œì˜ ë°˜í™˜ê°’ì´ ìˆì„ ë•Œ
let str = '{"title":"Conference","date":"2017-11-30T12:00:00.000Z"}';
	// new Date()ì˜ ê°’ì´ ë°˜í™˜ëœ 'date' í”„ë¡œí¼í‹°

JSON.parse(str).date.getDate() // ì—ëŸ¬! (ë‹¨ìˆœ ë¬¸ìì—´ì´ ë°˜í™˜ë˜ì—ˆê¸° ë•Œë¬¸)

let meetup = JSON.parse(str, (key, value) => {
  return key === 'date' ? new Date(value) : value;
	// key== date => new Date() ê°’ì„ ë°˜í™˜
});

alert( meetup.date.getDate() ); // ì œëŒ€ë¡œ ë™ì‘í•¨
```

# ì œë„ˆë ˆì´í„°

ì¼ë°˜ í•¨ìˆ˜ vs ì œë„ˆë ˆì´í„°

![Untitled](Asynchronous%20Programming%2080a4a4ad358a4f9ea5a46837769d0193/Untitled%206.png)

![Untitled](Asynchronous%20Programming%2080a4a4ad358a4f9ea5a46837769d0193/Untitled%207.png)